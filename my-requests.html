<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù…Ù„Ø®Øµ Ø·Ù„Ø¨Ùƒ - Car Parking Multiplayer</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
  <style>
    body {
      background: radial-gradient(circle at 60% 40%, #1b263b 0%, #0d1b2a 80%, #ff2e63 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: 'Tajawal', Arial, sans-serif;
      color: #fff;
      overflow-x: hidden;
    }
    .canvas-wrap {
      background: rgba(20,30,50,0.92);
      border-radius: 16px;
      box-shadow: 0 0 20px #ff2e63, 0 0 40px #08d9d6;
      padding: 10px;
      margin-top: 20px;
      width: 100%;
      max-width: 900px;
    }
    canvas {
      width: 100% !important;
      height: auto !important;
      display: block;
    }
    .neon-btn {
      background: #ff2e63;
      color: #fff;
      font-size: 1.2rem;
      font-weight: bold;
      padding: 10px 30px;
      border-radius: 30px;
      box-shadow: 0 0 20px #ff2e63, 0 0 40px #08d9d6;
      border: none;
      cursor: pointer;
      transition: box-shadow 0.3s, transform 0.2s;
      margin: 20px 0;
    }
    .neon-btn:hover {
      box-shadow: 0 0 40px #ff2e63, 0 0 80px #08d9d6;
      transform: scale(1.05);
    }
    /* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
    .sidebar {
      position: fixed;
      top: 0;
      right: -250px;
      width: 250px;
      height: 100%;
      background: rgba(20,30,50,0.95);
      box-shadow: -5px 0 15px rgba(0,0,0,0.5);
      padding: 20px;
      transition: 0.3s;
      z-index: 999;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .sidebar.active {
      right: 0;
    }
    .sidebar a {
      display: block;
      padding: 12px 0;
      color: #fff;
      text-decoration: none;
      font-size: 1.1rem;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      width: 100%;
    }
    .sidebar a:hover {
      color: #ff2e63;
    }
    /* Ø­Ø§ÙˆÙŠØ© Ù„Ù„ÙˆØ¬Ùˆ ÙˆØ²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ */
    .sidebar-header {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      width: 100%;
      margin-bottom: 20px;
    }
    .sidebar-logo {
      max-height: 50px;
      cursor: pointer;
      margin-left: 10px;
    }
    .close-btn {
      background: transparent;
      border: none;
      color: #fff;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 0;
      line-height: 1;
      user-select: none;
    }

    /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù‡Ø§ØªÙ */
    @media (max-width: 768px) {
      body {
        justify-content: flex-start;
        padding-top: 20px;
      }
      .canvas-wrap {
        margin-top: 80px;
        width: 95%;
      }
      
      #orderCanvas {
        height: 400px !important;
        object-fit: contain;
      }
      
      .neon-btn {
        margin-top: 20px;
        margin-bottom: 30px;
        width: 90%;
        max-width: 300px;
        font-size: 1rem;
        padding: 8px 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ø¨Ø§Ø± -->
  <img src="logo.png" alt="Logo" class="sidebar-logo" style="position: fixed; top: 10px; right: 10px; max-height: 80px; cursor: pointer;" onclick="toggleSidebar()"/>

  <!-- Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
  <div id="sidebar" class="sidebar" role="navigation" aria-label="Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ">
    <div class="sidebar-header">
      <button class="close-btn" aria-label="Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©" onclick="toggleSidebar()">Ã—</button>
      <img src="logo.png" alt="Logo" class="sidebar-logo" />
    </div>
    <a href="main.html">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="ready.html">Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</a>
    <a href="custom.html">Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©</a>
    <a href="info.html">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</a>
  </div>

  <div class="canvas-wrap">
    <canvas id="orderCanvas" width="900" height="700"></canvas>
  </div>
  <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ÙŠØ© -->
<div id="alert-message" class="bg-yellow-500 bg-opacity-80 text-black font-bold text-center py-3 px-4 rounded-md shadow-lg mt-4 max-w-lg mx-auto">
  ğŸ“¸ Ø±Ø¬Ø§Ø¡Ù‹ Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø·Ù„Ø¨Ùƒ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ù†Ø§ Ø¹Ø¨Ø± ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØŒ ÙˆØ³Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙƒ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª.
</div>

  <button class="neon-btn" onclick="downloadImage()">ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø·Ù„Ø¨Ùƒ</button>

  <script>
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
    }

    function getLastOrder() {
      const requests = JSON.parse(localStorage.getItem('cpm_requests') || '[]');
      return requests.length ? requests[requests.length - 1] : null;
    }

    function drawOrder(order) {
      const canvas = document.getElementById("orderCanvas");
      const ctx = canvas.getContext("2d");
      const isMobile = window.innerWidth <= 768;

      // Ø¶Ø¨Ø· Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ù„Ù„Ù‡Ø§ØªÙ
      if (isMobile) {
        canvas.width = window.innerWidth * 0.95;
        canvas.height = 400;
      }

      // Ø®Ù„ÙÙŠØ© Ù…ØªØ¯Ø±Ø¬Ø©
      const grad = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      grad.addColorStop(0, "#1b263b");
      grad.addColorStop(1, "#ff2e63");
      ctx.fillStyle = grad;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Ø¥Ø·Ø§Ø± Ù…Ø¶ÙŠØ¡
      ctx.strokeStyle = "#ffe600";
      ctx.lineWidth = 5;
      ctx.shadowColor = "#ff2e63";
      ctx.shadowBlur = 15;
      ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
      ctx.shadowBlur = 0;

      // Ø¹Ù†ÙˆØ§Ù†
      ctx.font = isMobile ? "bold 18px Tajawal, Arial" : "bold 28px Tajawal, Arial";
      ctx.fillStyle = "#fff";
      ctx.textAlign = "center";
      ctx.fillText("Ù…Ù„Ø®Øµ Ø·Ù„Ø¨Ùƒ ÙÙŠ Car Parking Multiplayer", canvas.width / 2, isMobile ? 35 : 50);

      // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
      ctx.font = isMobile ? "14px Tajawal, Arial" : "20px Tajawal, Arial";
      ctx.textAlign = "right";
      ctx.fillStyle = "#fff";

      const lines = [
        `Ø§Ù„Ø§Ø³Ù…: ${order.name || "-"}`,
        `Ø§Ù„Ø¨Ø±ÙŠØ¯: ${order.email || "-"}`,
        `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${order.phone || "-"}`,
        `Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª: ${order.cars || "-"}`,
        `Ø§Ù„ÙÙ„ÙˆØ³: ${order.money || "-"}`,
        `Ø§Ù„ÙƒÙˆÙŠÙ†Ø²: ${order.coins || "-"}`,
        `stiker&clothes: ${order.openPass || "-"}`,
        `ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨: ${order.verified ? "Ù†Ø¹Ù…" : "Ù„Ø§"}`,
        `Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${order.notes || "-"}`,
        `ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: ${order.createdAt ? new Date(order.createdAt).toLocaleDateString('ar-EG') : "-"}`
      ];

      // Ø¶Ø¨Ø· Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø·Ø± Ù„Ù„Ù‡Ø§ØªÙ
      const lineHeight = isMobile ? 28 : 40;
      const startY = isMobile ? 70 : 100;
      
      lines.forEach((line, i) => {
        ctx.fillText(line, canvas.width - (isMobile ? 15 : 40), startY + i * lineHeight);
      });

      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ÙˆØ¬Ùˆ Ù…Ø¹ Ø¶Ø¨Ø· Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
      const logoImg = new Image();
      logoImg.src = "logo1.png";

      logoImg.onload = () => {
        const logoWidth = isMobile ? canvas.width * 0.90 : 700;
        const logoHeight = isMobile ? canvas.width * 0.90 : 700;
        const logoX = isMobile ? -60 : -70;
        const logoY = isMobile ? 50 : 10;
        
        ctx.drawImage(logoImg, logoX, logoY, logoWidth, logoHeight);
      };
    }

    function downloadImage() {
      const canvas = document.getElementById("orderCanvas");
      const link = document.createElement("a");
      link.download = "Ø·Ù„Ø¨Ùƒ.png";
      link.href = canvas.toDataURL();
      link.click();
    }

    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù… Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
    window.addEventListener('resize', function() {
      const order = getLastOrder();
      if (order) drawOrder(order);
    });

    const order = getLastOrder();
    if (order) {
      drawOrder(order);
    } else {
      document.querySelector(".canvas-wrap").innerHTML = "<p style='color:#fff;text-align:center;font-size:1.5rem'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨ Ù„Ø¹Ø±Ø¶Ù‡</p>";
      document.querySelector(".neon-btn").style.display = "none";
    }
  </script>
</body>
</html>

